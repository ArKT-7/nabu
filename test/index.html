<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <script src="../dist/fastboot.mjs" type="module"></script>
    <script src="../download.js" type="module"></script>
    <meta property="og:title" content="Fastboot Tool by ArKT" />
    <meta property="og:description" content="It can boot Images like recovery and can flash images in any partition" />
    <meta property="og:url" content="https://arkt-7.github.io/nabu/" />
    <meta property="og:type" content="website" />
    <meta name="description" content="It can boot Images like recovery and can flash images in any partition" />
    <meta name="title" content="Fastboot Tool for flashing/booting/rooting" />
    <title>Fastboot Tool by ArKT</title>
    <link rel="icon" href="https://img.icons8.com/fluency/48/android.png" type="image/png">
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f0f0f0, #d4e0e5);
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            min-height: 100vh;
        }

        h1 {
            color: #333333;
            text-align: center;
            margin-bottom: 20px;
            font-size: 38px;
            text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.2);
        }

        h2 {
            color: #333333;
            margin-top: 0;
            margin-bottom: 5px;
            font-size: 24px;
            letter-spacing: 2px;
            background: linear-gradient(135deg, #007bff, #003b80);
            -webkit-background-clip: text;
            color: transparent;
            animation: textGlow 4s ease-in-out infinite;
        }

        .title {
            text-align: center;
            font-size: 32px;
            letter-spacing: 0.5px;
            color: #333333;
        }

        .text-gradient {
            background: linear-gradient(135deg, #007bff, #003b80);
            -webkit-background-clip: text;
            color: transparent;
            text-shadow: 
                0 0 3px rgba(0, 123, 255, 0.5),
                0 0 8px rgba(0, 123, 255, 0.3);
            animation: textGlow 2s ease-in-out infinite;
        }

        .subtitle {
            color: #333333;
            text-align: center;
            font-size: 24px;
            margin-top: -5px;
        }

        @keyframes textGlow {
            0%, 100% {
                text-shadow: 
                    0 0 8px rgba(0, 123, 255, 0.6),
                    0 0 16px rgba(0, 123, 255, 0.4);
            }
            50% {
                text-shadow: 
                    0 0 12px rgba(0, 123, 255, 0.6),
                    0 0 20px rgba(0, 123, 255, 0.4);
            }
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            margin: 30px 0;
            background: linear-gradient(135deg, #e0e6ed, #c8d0d8);
            background-size: 200% 200%;
            border-radius: 20px;
            position: relative;
            text-align: center;
            overflow: hidden;
            animation: backgroundMove 20s linear infinite;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .container::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, #ff9ecf, #a0b9ff, #d1e3ff, #ff9ecf);
            background-size: 400% 400%;
            border-radius: 20px;
            z-index: -1;
            filter: blur(10px);
            opacity: 0.8;
            animation: glow 10s ease infinite;
            box-shadow: 
                0 0 20px 10px rgba(255, 158, 207, 0.3),
                0 0 40px 10px rgba(255, 158, 207, 0.2) inset,
                -10px -10px 30px rgba(255, 158, 207, 0.5),
                10px -10px 30px rgba(255, 158, 207, 0.5),
                -10px 10px 30px rgba(255, 158, 207, 0.5),
                10px 10px 30px rgba(255, 158, 207, 0.5);
        }

        @keyframes glow {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        @keyframes backgroundMove {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        form {
            display: flex;
            flex-direction: column;
            width: 100%;
            align-items: center;
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(50px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .button {
            background: linear-gradient(135deg, #007bff, #00d4ff);
            border: none;
            border-radius: 20px;
            color: white;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.3s ease;
            margin: 10px 0;
            width: 100%;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
            animation: buttonGlow 3s ease-in-out infinite alternate;
        }

        .button:hover {
            background: linear-gradient(135deg, #0056b3, #0094c6);
            transform: scale(1.05);
        }
        
        .button:disabled {
            background: linear-gradient(135deg, #b0b0b0, #d4d4d4);
            color: #888;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

	.red-button {
	    background: linear-gradient(135deg, #ff3b3b, #ff6666); /* Brighter red shades */
	    border: none;
	    border-radius: 20px;
	    color: white;
	    padding: 15px 20px;
	    font-size: 18px;
	    font-weight: bold;
	    cursor: pointer;
	    transition: background 0.3s ease, transform 0.3s ease;
	    margin: 10px 0;
	    width: 100%;
	    box-shadow: 0 4px 10px rgba(255, 59, 59, 0.5); /* Adjusted shadow for a more vibrant look */
	}
	
	.red-button:hover {
	    background: linear-gradient(135deg, #ff0000, #ff4d4d); /* More intense color on hover */
	}

	
	.red-button:disabled {
	    background: linear-gradient(135deg, #b0b0b0, #d4d4d4);
            color: #888;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }


	/* .flash-form, .boot-form, .rboot-flash-form, .command-form {
	    display: flex;
	    flex-direction: column;
	    align-items: center; /* Center the form horizontally
	    width: 100%; /* Full width for the form
	} */
	
	input[type="file"],
	input[type="text"],
	select {
	    text-align: center; /* Center align text inside input fields */
	    width: 100%; /* Use full width of the container */
	    max-width: 600px; /* Set a max width for better appearance */
	    padding: 15px 20px;
	    margin: 10px 0; /* Vertical spacing between inputs */
	    border-radius: 20px;
	    border: 1px solid #ccc; /* Light border for input fields */
	    box-sizing: border-box; /* Ensure padding and borders are included in the width */
	    background: linear-gradient(135deg, #f0f4f8, #e2e8f0); /* Light gradient background */
	    box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.08); /* Subtle shadow */
	    transition: all 0.3s ease;
	    -webkit-appearance: none; /* Remove default styling */
	    -moz-appearance: none; /* Remove default styling */
	    appearance: none; /* Remove default styling */
	    font-size: 14px;
	    font-weight: bold;
	    color: #333; /* Dark text color for light mode */
	}
	
	input[type="file"] {
	    box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.05); /* Minimal shadow */
	    transition: all 0.3s ease;
	    -webkit-appearance: none; /* Remove default styling */
	    -moz-appearance: none; /* Remove default styling */
	    appearance: none; /* Remove default styling */
	    background: linear-gradient(135deg, #f0f4f8, #e2e8f0); /* Match gradient to other inputs */
	    color: #333; /* Text color for light mode */
	}
	
	label {
	    font-weight: bold;
	    display: block;
	    margin-bottom: 12px;
	    font-size: 19px;
	    text-shadow: 1px 1px 10px rgba(0, 0, 0, 0.1);
	}
	
	label2 {
	    font-weight: bold;
	    display: block;
	    margin-bottom: 6px;
	    margin-top: 8px;
	    font-size: 18px;
	    text-shadow: 1px 1px 10px rgba(0, 0, 0, 0.1);
	}
	
	.progress-container {
	    width: 100%;
	    height: 30px;
	    background-color: #f3f3f3;
	    border-radius: 15px;
	    overflow: hidden;
	    margin-top: 10px;
	    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
	    display: none; /* Initially hidden */
	}
	
	.progress-bar {
	    height: 100%;
	    width: 0%;
	    background-color: #4caf50;
	    transition: width 0.5s ease;
	    border-radius: 15px;
	}
	
	.status-field {
	    font-weight: bold;
	    display: block;
	    margin-bottom: 10px;
	    margin-top: 1px;
	    font-size: 20px;
	    text-shadow: 1px 1px 10px rgba(0, 0, 0, 0.1);
	}
	
	pre.result-field {
            background: linear-gradient(135deg, #f0f4f8, #e2e8f0); 
            padding: 20px;
            border-radius: 15px;
            overflow-y: auto; 
            overflow-x: auto; 
            max-height: 200px; 
            border: 1px solid #ccc;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 90%; 
            margin-top: 0; 
            position: relative; 
            color: black;
            white-space: pre-wrap;
        }

        pre.result-field::-webkit-scrollbar {
            width: 12px; 
            background: transparent; 
        }

        pre.result-field::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.5); 
            border-radius: 10px; 
            border: 3px solid transparent; 
            background-clip: padding-box; 
        }

        pre.result-field::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.7);
        }
		
	#progress-overlay {
	    position: fixed;
	    top: 0;
	    left: 0;
	    right: 0;
	    bottom: 0;
	    background-color: rgba(0, 0, 0, 0.7);
	    display: none; /* Hidden initially */
	    justify-content: center;
	    align-items: center;
	    z-index: 1000; /* Bring it above everything */
	}
	
	#progress-overlay.active {
	    display: flex;
	}
	
	#progress-message {
	    color: white;
	    font-size: 24px;
	    text-align: center;
	    padding: 20px;
	    background-color: rgba(0, 0, 0, 0.8);
	    border-radius: 10px;
	    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
	    animation: pulse 1.5s infinite;
	}
	
	@keyframes pulse {
	    0% {
	        transform: scale(1);
	    }
	    50% {
	        transform: scale(1.05);
	    }
	    100% {
	        transform: scale(1);
	    }
	}
	
	/* Neumorphic Buttons */
	.rboot-button {
	    background-color: #007bff;
	    color: white;
	    border: none;
	    padding: 15px 25px;
	    cursor: pointer;
	    border-radius: 20px;
	    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.15), -4px -4px 10px rgba(255, 255, 255, 0.7);
	    transition: box-shadow 0.3s, transform 0.2s;
	}
	
	.rboot-button:hover {
	    background-color: #0056b3;
	    box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15), -2px -2px 6px rgba(255, 255, 255, 0.7);
	    transform: translateY(-3px);
	}
	
	/* Progress Bar */
	/* .rboot-progress-container {
	    width: 100%;
	    background-color: #f3f3f3;
	    border-radius: 20px;
	    margin: 20px 0;
	    height: 30px;
	    overflow: hidden;
	    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
	}
	
	.rboot-progress-bar {
	    width: 0%;
	    height: 100%;
	    background-color: #4caf50;
	    border-radius: 20px;
	    transition: width 0.4s ease;
	} */
	
	.rboot-progress-container {
	    width: 100%;
	    height: 30px;
	    background-color: #f3f3f3;
	    border-radius: 15px;
	    overflow: hidden;
	    margin-top: 10px;
	    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
	    display: none; /* Initially hidden */
	}
	
	.rboot-progress-bar {
	    height: 100%;
	    width: 0%;
	    background-color: #4caf50;
	    transition: width 0.5s ease;
	    border-radius: 15px;
	}
	
	.switchx {
	    font-size: 17px;
	    position: absolute;
	    top: 7px; /* Adjust for positioning */
	    right: 7px; /* Adjust for positioning */
	    display: inline-block;
	    width: 40px; /* Reduced width */
	    height: 22px; /* Reduced height */
	}
	
	.switchx input {
	    opacity: 0;
	    width: 0;
	    height: 0;
	}
	
	.slider {
	    position: absolute;
	    cursor: pointer;
	    top: 0;
	    left: 0;
	    right: 0;
	    bottom: 0;
	    background: linear-gradient(135deg, #e0e6ed, #c8d0d8); /* Light mode gradient */
	    transition: 0.4s;
	    border-radius: 15px; /* Smaller border radius */
	    box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.2), 0 3px 6px rgba(0, 0, 0, 0.1); /* Adjusted depth effect */
	}
	
	.slider:before {
	    position: absolute;
	    content: "";
	    height: 18px; /* Smaller knob */
	    width: 18px; /* Smaller knob */
	    border-radius: 50%; /* Circular knob */
	    left: 2px;
	    bottom: 2px;
	    z-index: 2;
	    background-color: #e8e8e8;
	    transition: 0.4s;
	    box-shadow: 0 3px 4px rgba(0, 0, 0, 0.2); /* Adjusted shadow for the smaller knob */
	}
	
	/* Adjusted sun icon for smaller size */
	.sun svg {
	    position: absolute;
	    top: 4px; /* Adjusted position */
	    left: 24px; /* Adjusted to fit smaller toggle */
	    z-index: 1;
	    width: 14px; /* Smaller size */
	    height: 14px; /* Smaller size */
	}
	
	/* Adjusted moon icon for smaller size */
	.moon svg {
	    fill: #73C0FC;
	    position: absolute;
	    top: 4px; /* Adjusted position */
	    left: 4px; /* Adjusted to fit smaller toggle */
	    z-index: 1;
	    width: 14px; /* Smaller size */
	    height: 14px; /* Smaller size */
	}
	
	/* When slider is checked (dark mode) */
	input:checked + .slider {
	    background: linear-gradient(135deg, #3a3f44, #50575d); /* Dark mode gradient with better contrast */
	    box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.5), 0 3px 6px rgba(0, 0, 0, 0.2); /* Dark mode depth */
	}
	
	input:checked + .slider:before {
	    background-color: #ffffff; /* Keep the knob white in dark mode */
	    transform: translateX(18px); /* Adjust translation for smaller slider */
	    box-shadow: 0 3px 4px rgba(0, 0, 0, 0.3); /* Knob shadow in dark mode */
	}
	
	.inputx:focus + .slider {
	    box-shadow: 0 0 1px #183153;
	}

	.animated-button img {
	    transition: transform 0.3s ease, opacity 0.3s ease;
	}
	
	.animated-button:hover img {
	    transform: scale(1.1);
	    opacity: 0.9; 
	}


</style>
</head>
<body>
    <h1 class="title">
        <span class="text-gradient">Nabu Fastboot Tool</span>
    </h1>
    <h2 class="subtitle">By °⊥⋊ɹ∀° :)</h2>

    <!-- Add a progress overlay for the "Processing... Please wait" message -->
    <div id="progress-overlay">
        <div id="progress-message">Processing... Please wait</div>
    </div>

    <div class="container">
        <label class="switchx">
            <span class="sun">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <g fill="#ffd43b">
                        <circle r="5" cy="12" cx="12"></circle>
                        <path d="m21 13h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 0 2zm-17 0h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 0 2zm13.66-5.66a1 1 0 0 1 -.66-.29 1 1 0 0 1 0-1.41l.71-.71a1 1 0 1 1 1.41 1.41l-.71.71a1 1 0 0 1 -.75.29zm-12.02 12.02a1 1 0 0 1 -.71-.29 1 1 0 0 1 0-1.41l.71-.66a1 1 0 0 1 1.41 1.41l-.71.71a1 1 0 0 1 -.7.24zm6.36-14.36a1 1 0 0 1 -1-1v-1a1 1 0 0 1 2 0v1a1 1 0 0 1 -1 1zm0 17a1 1 0 0 1 -1-1v-1a1 1 0 0 1 2 0v1a1 1 0 0 1 -1 1zm-5.66-14.66a1 1 0 0 1 -.7-.29l-.71-.71a1 1 0 0 1 1.41-1.41l.71.71a1 1 0 0 1 0 1.41 1 1 0 0 1 -.71.29zm12.02 12.02a1 1 0 0 1 -.7-.29l-.66-.71a1 1 0 0 1 1.36-1.36l.71.71a1 1 0 0 1 0 1.41 1 1 0 0 1 -.71.24z"></path>
                    </g>
                </svg>
            </span>
            <span class="moon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                    <path d="m223.5 32c-123.5 0-223.5 100.3-223.5 224s100 224 223.5 224c60.6 0 115.5-24.2 155.8-63.4 5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6-96.9 0-175.5-78.8-175.5-176 0-65.8 36-123.1 89.3-153.3 6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path>
                </svg>
            </span>
            <input type="checkbox" class="inputx" id="toggle-input">
            <span class="slider"></span>
        </label>

        <p class="status-field">Not connected in Fastboot</p>
        <button class="button connect-button">Connect device Fastboot</button>
    </div>

    <div class="container">
        <form class="command-form">
            <label for="command">Fastboot Commands</label>
            <input type="text" name="command" class="command-input" placeholder="Enter fastboot command here without 'fastboot'" />
            <input type="submit" value="Send" class="button" />
        </form>
        <button class="button reboot-button">Reboot Device</button>
        <button class="button reboot-bootloader-button">Reboot to Bootloader</button>
        <button class="button reboot-recovery-button">Reboot to Recovery</button>
        <button class="button reboot-fastbootd-button">Reboot to FastbootD</button>
        <button class="button reboot-edl-button">Reboot to EDL</button>
	<button class="button switchslot-button">Switch slot to other</button>
	    <p id="warning-message" style="text-align: center; margin-top: 6px;">
	            <strong>- Output logs - </strong>
	        </p>
            <pre class="result-field"></pre>
    </div>

 <!-- New Container for Downloading and Flashing Images -->
    <div class="container">
        <form class="rboot-flash-form">
            <label for="rboot-flash-file">Flash any rooted or normal boot image</label>
            <input type="file" name="rboot-flash-file" class="rboot-flash-file" accept=".img" />
            <label for="rboot-flash-partition">Select Flash boot partition</label>
            <select name="rboot-flash-partition" class="rboot-flash-partition" required>
                <option value="">Select boot partition</option>
                <option value="boot_ab" selected>Flash to Boot ab (both slots)</option>
                <option value="boot">Flash to Boot (current slot)</option>
                <option value="boot_a">Flash to Boot A only</option>
                <option value="boot_b">Flash to Boot B only</option>
            </select>
            <label for="rboot-flash-image">Magisk V28 Rooted Boot Images</label>
            <select name="rboot-flash-image" class="rboot-flash-image">
                <option value="">Select rooted HyperOS/MIUI 13/14 boot</option>

		<!-- Global Versions HyperOS-->
		<option value="magisk-1-0-6-global">HyperOS 1.0.6 (Global)</option>
                <option value="magisk-1-0-5-global">HyperOS 1.0.5 (Global)</option>
                <option value="magisk-1-0-4-global">HyperOS 1.0.4 (Global)</option>
	    	<option value="magisk-1-0-1-global">HyperOS 1.0.1 (Global)</option>

		<!-- India Versions -->
		<option value="magisk-1-0-9-india">HyperOS 1.0.9 (India)</option>    
	    	<option value="magisk-1-0-8-india">HyperOS 1.0.8 (India)</option>
	    	<option value="magisk-1-0-7-india">HyperOS 1.0.7 (India)</option>
	    	<option value="magisk-1-0-4-india">HyperOS 1.0.4 (India)</option>

		<!-- EEA Versions -->
		<option value="magisk-1-0-6-eea">HyperOS 1.0.6 (EEA)</option>
	    	<option value="magisk-1-0-5-eea">HyperOS 1.0.5 (EEA)</option>
	    	<option value="magisk-1-0-2-eea">HyperOS 1.0.2 (EEA)</option>
	   	<option value="magisk-1-0-1-eea">HyperOS 1.0.1 (EEA)</option>

		<!-- Russia Versions -->
		<option value="magisk-1-0-5-russia">HyperOS 1.0.5 (Russia)</option>
	    	<option value="magisk-1-0-4-russia">HyperOS 1.0.4 (Russia)</option>
	    	<option value="magisk-1-0-3-russia">HyperOS 1.0.3 (Russia)</option>
	    	<option value="magisk-1-0-1-russia">HyperOS 1.0.1 (Russia)</option>

		<!-- China Versions -->
	    	<option value="magisk-1-0-3-china">HyperOS 1.0.3 (China)</option>
	    	<option value="magisk-1-0-2-china">HyperOS 1.0.2 (China)</option>

		<!-- Turkey Versions -->
		<option value="magisk-1-0-6-turkey">HyperOS 1.0.6 (Turkey)</option>
	    	<option value="magisk-1-0-5-turkey">HyperOS 1.0.5 (Turkey)</option>
	    	<option value="magisk-1-0-4-turkey">HyperOS 1.0.4 (Turkey)</option>
	    	<option value="magisk-1-0-2-turkey">HyperOS 1.0.2 (Turkey)</option>

		<!-- Taiwan Versions -->
		<option value="magisk-1-0-6-taiwan">HyperOS 1.0.6 (Taiwan)</option>
	    	<option value="magisk-1-0-5-taiwan">HyperOS 1.0.5 (Taiwan)</option>
	    	<option value="magisk-1-0-4-taiwan">HyperOS 1.0.4 (Taiwan)</option>
	    	<option value="magisk-1-0-2-taiwan">HyperOS 1.0.2 (Taiwan)</option>
	
	    	<!-- Global Versions MIUI 14-->
	    	<option value="magisk-14-0-8-global">MIUI 14.0.8 (Global)</option>
	    	<option value="magisk-14-0-7-global">MIUI 14.0.7 (Global)</option>
	    	<option value="magisk-14-0-6-global">MIUI 14.0.6 (Global)</option>
	    	<option value="magisk-14-0-5-global">MIUI 14.0.5 (Global)</option>
	    	<option value="magisk-14-0-4-global">MIUI 14.0.4 (Global)</option>
	    	<option value="magisk-14-0-3-global">MIUI 14.0.3 (Global)</option>
	    
	    	<!-- India Versions -->
	    	<option value="magisk-14-0-7-india">MIUI 14.0.7 (India)</option>
	    	<option value="magisk-14-0-4-india">MIUI 14.0.4 (India)</option>
	    	<option value="magisk-14-0-3-india">MIUI 14.0.3 (India)</option>
	    	<option value="magisk-14-0-1-india">MIUI 14.0.1 (India)</option>
	    
	    	<!-- EEA Versions -->
	    	<option value="magisk-14-0-9-eea">MIUI 14.0.9 (EEA)</option>
	    	<option value="magisk-14-0-8-eea">MIUI 14.0.8 (EEA)</option>
	    	<option value="magisk-14-0-7-eea">MIUI 14.0.7 (EEA)</option>
	    	<option value="magisk-14-0-6-eea">MIUI 14.0.6 (EEA)</option>
	    	<option value="magisk-14-0-5-eea">MIUI 14.0.5 (EEA)</option>
	    	<option value="magisk-14-0-4-eea">MIUI 14.0.4 (EEA)</option>
	    	<option value="magisk-14-0-2-eea">MIUI 14.0.2 (EEA)</option>
	    
	    	<!-- Russia Versions -->
	    	<option value="magisk-14-0-7-russia">MIUI 14.0.7 (Russia)</option>
	    	<option value="magisk-14-0-6-russia">MIUI 14.0.6 (Russia)</option>
	    	<option value="magisk-14-0-5-russia">MIUI 14.0.5 (Russia)</option>
	    	<option value="magisk-14-0-4-russia">MIUI 14.0.4 (Russia)</option>
	    	<option value="magisk-14-0-3-russia">MIUI 14.0.3 (Russia)</option>
	    	<option value="magisk-14-0-2-russia">MIUI 14.0.2 (Russia)</option>
	    
	    	<!-- China Versions -->
	    	<option value="magisk-14-0-7-china">MIUI 14.0.7 (China)</option>
	    	<option value="magisk-14-0-6-china">MIUI 14.0.6 (China)</option>
	    	<option value="magisk-14-0-5-china">MIUI 14.0.5 (China)</option>
	    	<option value="magisk-14-0-4-china">MIUI 14.0.4 (China)</option>
	    
	    	<!-- Turkey Versions -->
	    	<option value="magisk-14-0-5-turkey">MIUI 14.0.5 (Turkey)</option>
	    	<option value="magisk-14-0-4-turkey">MIUI 14.0.4 (Turkey)</option>
	    	<option value="magisk-14-0-2-turkey">MIUI 14.0.2 (Turkey)</option>
	    	<option value="magisk-14-0-1-turkey">MIUI 14.0.1 (Turkey)</option>
	    
	    	<!-- Taiwan Versions -->
	    	<option value="magisk-14-0-3-taiwan">MIUI 14.0.3 (Taiwan)</option>
	    	<option value="magisk-14-0-2-taiwan">MIUI 14.0.2 (Taiwan)</option>
	    	<option value="magisk-14-0-1-taiwan">MIUI 14.0.1 (Taiwan)</option>

		<!-- Global Versions MIUI 13-->
		<option value="magisk-13-1-4-global">MIUI 13.1.4 (Global)</option>
		<option value="magisk-13-1-3-global">MIUI 13.1.3 (Global)</option>
		<option value="magisk-13-0-4-global">MIUI 13.0.4 (Global)</option>
		<option value="magisk-13-0-3-global">MIUI 13.0.3 (Global)</option>
		<option value="magisk-13-0-2-global">MIUI 13.0.2 (Global)</option>
		<option value="magisk-13-0-1-global">MIUI 13.0.1 (Global)</option>
		
		<!-- India Versions -->
		<option value="magisk-13-1-8-india">MIUI 13.1.8 (India)</option>
		<option value="magisk-13-1-4-india">MIUI 13.1.4 (India)</option>
		<option value="magisk-13-1-3-india">MIUI 13.1.3 (India)</option>
		<option value="magisk-13-0-6-india">MIUI 13.0.6 (India)</option>
		<option value="magisk-13-0-5-india">MIUI 13.0.5 (India)</option>
		<option value="magisk-13-0-4-india">MIUI 13.0.4 (India)</option>
		
		<!-- Russia Versions -->
		<option value="magisk-13-1-6-russia">MIUI 13.1.6 (Russia)</option>
		<option value="magisk-13-1-4-russia">MIUI 13.1.4 (Russia)</option>
		<option value="magisk-13-0-3-russia">MIUI 13.0.3 (Russia)</option>
		<option value="magisk-13-0-2-russia">MIUI 13.0.2 (Russia)</option>
		<option value="magisk-13-0-1-russia">MIUI 13.0.1 (Russia)</option>
		
		<!-- EEA Versions -->
		<option value="magisk-13-1-5-eea">MIUI 13.1.5 (EEA)</option>
		<option value="magisk-13-1-3-eea">MIUI 13.1.3 (EEA)</option>
		<option value="magisk-13-1-2-eea">MIUI 13.1.2 (EEA)</option>
		<option value="magisk-13-0-6-eea">MIUI 13.0.6 (EEA)</option>
		<option value="magisk-13-0-5-eea">MIUI 13.0.5 (EEA)</option>
		<option value="magisk-13-0-4-eea">MIUI 13.0.4 (EEA)</option>
		<option value="magisk-13-0-3-eea">MIUI 13.0.3 (EEA)</option>
		
		<!-- China Versions -->
		<option value="magisk-13-1-5-china">MIUI 13.1.5 (China)</option>
		<option value="magisk-13-1-4-china">MIUI 13.1.4 (China)</option>
		<option value="magisk-13-0-9-china">MIUI 13.0.9 (China)</option>
		<option value="magisk-13-0-8-china">MIUI 13.0.8 (China)</option>
		<option value="magisk-13-0-5-china">MIUI 13.0.5 (China)</option>
		<option value="magisk-13-0-3-china">MIUI 13.0.3 (China)</option>
		
		<!-- Turkey Versions -->
		<option value="magisk-13-1-2-turkey">MIUI 13.1.2 (Turkey)</option>
		<option value="magisk-13-0-3-turkey">MIUI 13.0.3 (Turkey)</option>
		<option value="magisk-13-0-2-turkey">MIUI 13.0.2 (Turkey)</option>
		<option value="magisk-13-0-1-turkey">MIUI 13.0.1 (Turkey)</option>
		
		<!-- Taiwan Versions -->
		<option value="magisk-13-1-2-taiwan">MIUI 13.1.2 (Taiwan)</option>
		<option value="magisk-13-0-4-taiwan">MIUI 13.0.4 (Taiwan)</option>
		<option value="magisk-13-0-3-taiwan">MIUI 13.0.3 (Taiwan)</option>
		<option value="magisk-13-0-2-taiwan">MIUI 13.0.2 (Taiwan)</option>

	    </select>
		<input type="submit" value="Flash" class="button" />
		<!-- Progress bar for feedback -->
		<div class="rboot-progress-container" style="display:none;">
			<div class="rboot-progress-bar" style="width:0%;"></div>
		</div>
	</form>
    </div>

    <div class="container">
        <form class="boot-form">
            <label for="boot-file">Boot any images</label>
            <input type="file" name="boot-file" id="boot-file" accept=".img" />
            <select name="boot-type" class="boot-type">
                <option value="">Select Images to boot on Nabu directly</option>
            	<option value="twrp-portrait">Twrp Recovery Portrait</option>
		<option value="twrp-landscape">Twrp Recovery landscape</option>
            	<option value="pbrp-pitchblack">Pitch Black Recovery</option>
            	<option value="win-uefi">Windows UEFI Boot</option>
            	<option value="twrp-mod-portrait">Modded Twrp Recovery Portrait</option>
		<option value="twrp-mod-landscape">Modded Twrp Recovery landscape</option>
            	<option value="orangefox-mod">Modded OrangeFox Recovery</option>
            </select>
		<input type="submit" value="Boot" class="button" />
		<div class="progress-container" style="display: none;">
			<div class="progress-bar" style="width:0%;"></div>
		</div>
	</form>
    </div>
	
    <div class="container">
        <form class="flash-form">
            <label for="flash-file">Flash any images</label>
            <input type="file" name="flash-file" id="flash-file" accept=".img" />
            <label2 for="flash-partition">Enter Partition</label2>
            <input type="text" name="flash-partition" class="flash-partition" placeholder="Partition like - boot, dtbo, cust, recovery, etc." />
            <input type="submit" value="Flash" class="button" />
	</form>
    </div>



	<div class="container">
	    <form class="wipe-form">
	        <label for="wipe-input">Format/wipe make Partition Stock</label>
	        <p id="warning-message" style="text-align: center; font-style: italic; margin-bottom: 10px; margin-top: 10px;">
	            ⚠️ <strong>This will Format all data, including Android and Windows (if installed).</strong><br>
	            <strong>So think twice before doing.</strong>
	        </p>
	        <input type="text" name="wipe-input" class="wipe-input" placeholder="Type FORMAT - to remove Windows and make partition layout stock." />
	        <button type="button" class="button wipe-button red-button" disabled>Format/Wipe</button>
	    </form>
	</div>
	
	
    <div class="container">
    <h2 style="text-align: center;">Support My Journey</h2>
    <p style="text-align: center; font-style: italic; margin-bottom: 10px; margin-top: 10px;">"Your support fuels my passion for creating!"</p>
    <div class="button-container" style="text-align: center;">
        <a href="https://www.buymeacoffee.com/ArKT" target="_blank" class="animated-button">
            <img src="https://raw.githubusercontent.com/ArKT-7/WIN-ARM-DOWNLOADER/master/assets/buymecoffee.png" alt="Buy Me a Coffee" style="height: 60px; width: 217px; margin-top: 10px; margin-left: 10px; margin-right: 10px;">
        </a>
        <a href="https://www.paypal.me/arkt7" target="_blank" class="animated-button">
            <img src="https://raw.githubusercontent.com/ArKT-7/WIN-ARM-DOWNLOADER/master/assets/Paypal.png" alt="Donate via PayPal" style="height: 63px; width: 220px; margin-top: 10px; margin-right: 10px; margin-left: 10px;">
         </a>
      </div>
    </div>


<script type="module">
    import * as fastboot from "../dist/fastboot.mjs";
    import { BlobStore } from "../download.js";
    let device = new fastboot.FastbootDevice();
    window.device = device;
    let blobStore = new BlobStore();

    fastboot.setDebugLevel(2);


	   window.onload = function() {
            const toggleInput = document.getElementById('toggle-input');
            toggleInput.checked = false;
        };

        function redirectToUrl() {
            const toggleInput = document.getElementById('toggle-input');

            setTimeout(() => {
                window.location.href = "https://arkt-7.github.io/nabu/"; 
            }, 400);
        }

        const toggleInput = document.getElementById('toggle-input');
        toggleInput.addEventListener('change', function() {
            if (this.checked) {
                redirectToUrl(); 
            } else {
                this.checked = false;
            }
        });

        window.onbeforeunload = function() {
            const toggleInput = document.getElementById('toggle-input');
            toggleInput.checked = false;
        };

	   
let messageInterval;
let typingInterval; 
let clearingInterval; 
const progressMessage = document.getElementById('progress-message');
const messages = [
    'Hi its downloading, ig Flashing...',
    'idk may be Booting...',
    'Going inside device...xd',
    'IDK what\'s going on lol',
    'Processing... ig Please wait now'
];
const finalMessage = 'Please wait...'; 
let messageIndex = 0;
let isFinalLoop = false;

function typeMessage(message, callback) {
    let i = 0;
    progressMessage.textContent = '';
    typingInterval = setInterval(() => {
        if (i < message.length) {
            progressMessage.textContent += message[i];
            i++;
        } else {
            clearInterval(typingInterval);
            if (callback) callback(); 
        }
    }, 60);
}

function clearMessage(callback) {
    clearingInterval = setInterval(() => {
        if (progressMessage.textContent.length > 0) {
            progressMessage.textContent = progressMessage.textContent.slice(0, -1);
        } else {
            clearInterval(clearingInterval);
            if (callback) callback(); 
        }
    }, 50); 
}

function cycleMessages() {
    clearInterval(typingInterval);
    clearInterval(clearingInterval);
    clearMessage(() => {
        if (isFinalLoop) {
            typeMessage(finalMessage, () => {
                messageInterval = setTimeout(cycleMessages, 5000);
            });
        } else {
            typeMessage(messages[messageIndex], () => {
                messageIndex++;
                if (messageIndex < messages.length) {
                    messageInterval = setTimeout(cycleMessages, messageIndex === messages.length - 1 ? 5000 : 1000);
                } else {
                    isFinalLoop = true;
                    messageInterval = setTimeout(cycleMessages, 1000);
                }
            });
        }
    });
}

function showProgressOverlay() {
    const progressOverlay = document.getElementById('progress-overlay');
    const buttons = document.querySelectorAll('.button');
    progressOverlay.classList.add('active');
    buttons.forEach(button => {
        button.disabled = true;
    });
    messageIndex = 0;
    isFinalLoop = false;
    cycleMessages();
}

function hideProgressOverlay() {
    const progressOverlay = document.getElementById('progress-overlay');
    const buttons = document.querySelectorAll('.button');
    progressOverlay.classList.remove('active');
    buttons.forEach(button => {
        button.disabled = false;
    });
    clearTimeout(messageInterval);
    clearInterval(typingInterval);
    clearInterval(clearingInterval);

    messageIndex = 0; 
    isFinalLoop = false; 
    progressMessage.textContent = ''; 
}

function toggleElements(disable, isNabu = false) {
    const formElements = document.querySelectorAll("input, button, select");
    const wipeButton = document.querySelector(".wipe-button");
	wipeButton.disabled = true;
    formElements.forEach((element) => {
        if (!element.classList.contains('connect-button') && !element.closest('.switchx')) {
            element.disabled = disable; // General enable/disable logic
        }
    });
     
    // Specifically disable the select elements if nabu device is detected
    if (isNabu) {
        const rbootFlashSelect = document.querySelector(".rboot-flash-image");
        const bootTypeSelect = document.querySelector(".boot-type");
	

        if (rbootFlashSelect) {
            rbootFlashSelect.disabled = true; // Disable rboot-flash-image select
        }
        
        if (bootTypeSelect) {
            bootTypeSelect.disabled = true; // Disable boot-type select
        }
    }
	wipeButton.disabled = true;
}
	
	

function clearFormElements() {
    const formElements = document.querySelectorAll("input, button, select, textarea");

    let rbootPartitionSelect = document.querySelector('.rboot-flash-partition');
    let previousSelectedValue = rbootPartitionSelect ? rbootPartitionSelect.value : null;

    formElements.forEach((element) => {
        if (element.tagName === "INPUT" && (element.type === "text" || element.type === "file")) {
            element.value = "";
        } else if (element.tagName === "SELECT") {
            element.selectedIndex = 0;
        } else if (element.tagName === "TEXTAREA") {
            element.value = ""; 
        }
    });

    if (rbootPartitionSelect && previousSelectedValue !== null) {
        rbootPartitionSelect.value = previousSelectedValue;
    }
}
       

async function connectDevice() {
    let statusField = document.querySelector(".status-field");
    statusField.textContent = "Connecting...";

    try {
        await device.connect();
    } catch (error) {
        statusField.textContent = `Failed to connect to device: ${error.message}`;
        toggleElements(true); 
        return;
    }

    let product = await device.getVariable("product");
    let slot = await device.getVariable("current-slot");
    let serial = await device.getVariable("serialno");
    let bootloaderStatus = await device.getVariable("unlocked");
    let bootloaderStatusText = bootloaderStatus === "yes" ? "unlocked" : "locked";

    let deviceName = "";
    let isNabu = false;
    if (product === "nabu") {
        deviceName = "Device name - Xiaomi Pad 5";
	let rbootFlashPartitionSelect = document.querySelector('.rboot-flash-partition');
        if (rbootFlashPartitionSelect) {
            rbootFlashPartitionSelect.value = "boot_ab"; // Select the "Flash to Boot ab (both slots)"
        }
    } else if (product === "dm3q") {
        deviceName = "Device name - Samsung S23 Ultra";
	isNabu = true; // Device is not nabu
	// Select the current slot in the rboot-flash-partition select
        let rbootFlashPartitionSelect = document.querySelector('.rboot-flash-partition');
        if (rbootFlashPartitionSelect) {
            rbootFlashPartitionSelect.value = "boot"; // Select the "Flash to Boot (current slot)" option
        }
    } else  if (product !== "nabu") {
        isNabu = true; // Device is not nabu
	deviceName = "Device name - IDK LoL 😂";
	// Select the current slot in the rboot-flash-partition select
        let rbootFlashPartitionSelect = document.querySelector('.rboot-flash-partition');
        if (rbootFlashPartitionSelect) {
            rbootFlashPartitionSelect.value = "boot"; // Select the "Flash to Boot (current slot)" option
        }
    }

    let status = `Connected to - ${product} <br /> Current slot - ${slot} <br /> (serial: ${serial})`;
    if (deviceName) {
        status += `<br />${deviceName}`;
    }

    status += `<br />Bootloader status: ${bootloaderStatusText}`;
    statusField.innerHTML = status;

    // Call toggleElements with the isNabu flag
    toggleElements(false, isNabu); 
}

    toggleElements(true); 


    function handleDisconnect() {
        let statusField = document.querySelector(".status-field");
        statusField.textContent = "Not connected in Fastboot";
        toggleElements(true); 
    }

async function checkDeviceConnection() {
	const wipeButton = document.querySelector(".wipe-button");
	wipeButton.disabled = true;
    let statusField = document.querySelector(".status-field");

    try {
        let product = await device.getVariable("product");
        if (product) {
        }
    } catch (error) {
        statusField.textContent = "Device disconnected!";
        toggleElements(true);
    }
    clearFormElements();
}

async function sendFormCommand(event) {
    event.preventDefault();
    let inputField = document.querySelector(".command-input");
    let command = inputField.value.trim();
    let resultField = document.querySelector(".result-field");

    if (!command) {
        resultField.textContent += "Please enter a command!\n";
        alert("Please enter a command!");
        return;
    }

    try {
        let result = (await device.runCommand(command)).text;
        resultField.textContent += `Command executed successfully: ${result}\n`;
        alert(`Command executed successfully: ${result}`);
    } catch (error) {
        resultField.textContent += `Error executing command: ${error.message}\n`;
        alert(`Error executing command: ${error.message}`);
    } finally {
        inputField.value = "";
        await checkDeviceConnection();
    }
}

async function rebootDevice() {
    await runRebootCommand("reboot", "Device rebooted successfully!");
}

async function rebootToBootloader() {
    await runRebootCommand("reboot-bootloader", "Rebooted to Bootloader successfully!");
}

async function rebootToRecovery() {
    await runRebootCommand("reboot-recovery", "Rebooted to Recovery successfully!");
}

async function rebootToFastbootD() {
    await runRebootCommand("reboot-fastboot", "Rebooted to FastbootD successfully!");
}

async function rebootToEDL() {
    await runRebootCommand("oem edl", "Rebooted to EDL successfully!");
}

async function switchSlot() {
    let resultField = document.querySelector(".result-field");
    try {
        // Get the current slot
        let activeSlot = (await device.runCommand("getvar:current-slot")).text.trim();
        let otherSlot = activeSlot === "a" ? "b" : "a";

        // Switch to the other slot
        let result = (await device.runCommand(`set_active:${otherSlot}`)).text;

        // Confirm the slot switch
        resultField.textContent += `Switched to slot ${otherSlot}: ${result}\n`;
        alert(`Switched to slot ${otherSlot}: ${result}`);
        
        if (confirm(`Switched to slot ${otherSlot}. Click "OK" to reconnect the device.`)) {
            document.querySelector(".connect-button").click();
        }
    } catch (error) {
        resultField.textContent += `Error switching slots: ${error.message}\n`;
        alert(`Error switching slots: ${error.message}`);
    } finally {
        await checkDeviceConnection();
    }
}

async function runRebootCommand(command, successMessage) {
    let resultField = document.querySelector(".result-field");
    try {
        let result = (await device.runCommand(command)).text;
        resultField.textContent += `${successMessage}\n`;
        alert(successMessage);
    } catch (error) {
        resultField.textContent += `Error during reboot: ${error.message}\n`;
        alert(`Error during reboot: ${error.message}`);
    } finally {
        await checkDeviceConnection();
    }
}

    async function bootFormFile(event) {
        event.preventDefault();
        showProgressOverlay();
        let fileField = document.querySelector("#boot-file");
        let bootTypeSelect = document.querySelector(".boot-type");
        let selectedBootType = bootTypeSelect.value;

        let file;
        if (fileField.files.length > 0) {
            file = fileField.files[0];
        } else if (selectedBootType) {
            file = await downloadBootImage(getImagePath(selectedBootType));
        } else {
            alert("Please select a boot image file or choose a boot type!");
            hideProgressOverlay();
            return;
        }

        if (!file) {
            alert("Failed to obtain a valid boot image.");
            hideProgressOverlay();
            return;
        }

        try {
            await device.bootBlob(file);
            alert("Boot image booted successfully!");
        } catch (error) {
            console.error("Error booting image:", error);
            alert("Error booting image. Please try again.");
        } finally {
            fileField.value = ""; 
            bootTypeSelect.selectedIndex = 0; 
            hideProgressOverlay();
            await checkDeviceConnection(); 
        }
    }
    

    function getImagePath(selectedBootType) {
        switch (selectedBootType) {
            case "twrp-portrait":
                return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/recovery/twrp-portrait-nabu.img";
	    case "twrp-landscape":
                return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/recovery/twrp-landscape-nabu.img";
	    case "pbrp-pitchblack":
                return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/recovery/pitchblack-nabu.img";
            case "win-uefi":
                return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/recovery/uefi-windows-nabu.img";
            case "twrp-mod-portrait":
                return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/recovery/modded-twrp-portrait-nabu.img";
	    case "twrp-mod-landscape":
                return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/recovery/modded-twrp-landscape-nabu.img";
            case "orangefox-mod":
                return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/recovery/modded-orangefox-nabu.img";
            default:
                return null;
        }
    }

    async function downloadBootImage(imagePath) {
        const progressBarContainer = document.querySelector('.progress-container');
        const progressBar = document.querySelector('.progress-bar');
        progressBarContainer.style.display = 'block';

        try {
            const response = await fetch(imagePath);
            if (!response.ok) throw new Error("Failed to download boot image");

            const contentLength = response.headers.get('Content-Length');
            const total = parseInt(contentLength, 10);
            let loaded = 0;

            const reader = response.body.getReader();
            const chunks = [];

            while (true) {
                const { done, value } = await reader.read();
                if (done) break;
                chunks.push(value);
                loaded += value.length;
                progressBar.style.width = `${(loaded / total) * 100}%`;
            }

            const blob = new Blob(chunks);
            return blob;
        } catch (error) {
            console.error("Download error:", error);
            alert("Error downloading boot image. Please try again.");
        } finally {
            progressBarContainer.style.display = 'none';
            progressBar.style.width = `0%`;
        }
    }

    async function flashFormFile(event) {
        event.preventDefault();
        showProgressOverlay();
        let fileField = document.querySelector("#flash-file");
        let partField = document.querySelector(".flash-partition");
        let file = fileField.files[0];

        if (!file) {
            alert("Please select a file to flash!");
            hideProgressOverlay();
            return;
        }

        if (!partField.value) {
            alert("Please specify a partition to flash!");
            hideProgressOverlay();
            return;
        }

        try {
            await device.flashBlob(partField.value, file);
            alert(`Successfully flashed ${partField.value}`);
        } catch (error) {
            alert(`Failed to flash: ${error.message}`);
        } finally {
            fileField.value = "";
            partField.value = "";
            hideProgressOverlay();
            await checkDeviceConnection();
        }
    }


       async function rbootFlashFormFile(event) {
    event.preventDefault();
    rbootShowProgressOverlay();
           showProgressOverlay();

    let fileField = document.querySelector(".rboot-flash-file");
    let partField = document.querySelector(".rboot-flash-partition"); 
    let selectedImage = document.querySelector(".rboot-flash-image").value;

    let file;
    if (fileField.files.length > 0) {
        file = fileField.files[0];
    } else if (selectedImage) {
        file = await rbootDownloadFlashImage(rbootGetImagePath(selectedImage));
    } else {
        alert("Please select a file to flash or choose a predefined image!");
        rbootHideProgressOverlay();
        hideProgressOverlay();
        return;
    }

    if (!file || !partField.value) {
        alert("Please select a valid file and partition!");
        rbootHideProgressOverlay();
        hideProgressOverlay();
        return;
    }

    try {
        await device.flashBlob(partField.value, file);
        alert(`Successfully flashed to ${partField.value}`);
    } catch (error) {
        alert(`Failed to flash: ${error.message}`);
    } finally {
        fileField.value = "";
        rbootHideProgressOverlay();
        hideProgressOverlay();
        await checkDeviceConnection();
    }
}


function rbootGetImagePath(selectedImage) {
    switch (selectedImage) {
         // HyperOS GLOBAL Versions
	case "magisk-1-0-6-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.6.0.TKXMIXM.GLOBAL.boot.img";
	case "magisk-1-0-5-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.5.0.TKXMIXM.GLOBAL.boot.img";
        case "magisk-1-0-4-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.4.0.TKXMIXM.GLOBAL.boot.img";
        case "magisk-1-0-1-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.1.0.TKXMIXM.GLOBAL.boot.img";
        
	// India Versions    
	case "magisk-1-0-9-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.9.0.TKXINXM.INDIA.boot.img";
	case "magisk-1-0-8-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.8.0.TKXINXM.INDIA.boot.img";
        case "magisk-1-0-7-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.7.0.TKXINXM.INDIA.boot.img";
        case "magisk-1-0-4-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.4.0.TKXINXM.INDIA.boot.img";
        
	// EEA Versions  
	case "magisk-1-0-6-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.6.0.TKXEUXM.EEA.boot.img";
	case "magisk-1-0-5-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.5.0.TKXEUXM.EEA.boot.img";
        case "magisk-1-0-2-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.2.0.TKXEUXM.EEA.boot.img";
        case "magisk-1-0-1-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.1.0.TKXEUXM.EEA.boot.img";
        
	// Russia Versions    
	case "magisk-1-0-5-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.5.0.TKXRUXM.RUSSIA.boot.img";
	case "magisk-1-0-4-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.4.0.TKXRUXM.RUSSIA.boot.img";
        case "magisk-1-0-3-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.3.0.TKXRUXM.RUSSIA.boot.img";
        case "magisk-1-0-1-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.1.0.TKXRUXM.RUSSIA.boot.img";
        
	// China Versions    
	case "magisk-1-0-3-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.3.0.TKXCNXM.CHINA.boot.img";
        case "magisk-1-0-2-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.2.0.TKXCNXM.CHINA.boot.img";
        
	// Turkey Versions
	case "magisk-1-0-6-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.6.0.TKXTRXM.TURKEY.boot.img";
	case "magisk-1-0-5-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.5.0.TKXTRXM.TURKEY.boot.img";
        case "magisk-1-0-4-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.4.0.TKXTRXM.TURKEY.boot.img";
        case "magisk-1-0-2-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.2.0.TKXTRXM.TURKEY.boot.img";
        
	// taiwan Versions
	case "magisk-1-0-6-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.6.0.TKXTWXM.TAIWAN.boot.img";
	case "magisk-1-0-5-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.5.0.TKXTWXM.TAIWAN.boot.img";
        case "magisk-1-0-4-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.4.0.TKXTWXM.TAIWAN.boot.img";
        case "magisk-1-0-2-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/hyperos-rooted-boot/Magisk.28.NABU.OS1.0.2.0.TKXTWXM.TAIWAN.boot.img";
        
	// MIUI 14 GLOBAL Versions
        case "magisk-14-0-8-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.8.0.TKXMIXM.GLOBAL.boot.img";
        case "magisk-14-0-7-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.7.0.TKXMIXM.GLOBAL.boot.img";
        case "magisk-14-0-6-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.6.0.TKXMIXM.GLOBAL.boot.img";
        case "magisk-14-0-5-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.5.0.TKXMIXM.GLOBAL.boot.img";
        case "magisk-14-0-4-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.4.0.TKXMIXM.GLOBAL.boot.img";
        case "magisk-14-0-3-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.3.0.TKXMIXM.GLOBAL.boot.img";

	// India Versions	    
        case "magisk-14-0-7-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.7.0.TKXINXM.INDIA.boot.img";
        case "magisk-14-0-4-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.4.0.TKXINXM.INDIA.boot.img";
        case "magisk-14-0-3-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.3.0.TKXINXM.INDIA.boot.img";
        case "magisk-14-0-1-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.1.0.TKXINXM.INDIA.boot.img";

	// EEA Versions	    
        case "magisk-14-0-9-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.9.0.TKXEUXM.EEA.boot.img";
        case "magisk-14-0-8-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.8.0.TKXEUXM.EEA.boot.img";
        case "magisk-14-0-7-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.7.0.TKXEUXM.EEA.boot.img";
        case "magisk-14-0-6-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.6.0.TKXEUXM.EEA.boot.img";
        case "magisk-14-0-5-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.5.0.TKXEUXM.EEA.boot.img";
        case "magisk-14-0-4-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.4.0.TKXEUXM.EEA.boot.img";
        case "magisk-14-0-2-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.2.0.TKXEUXM.EEA.boot.img";

	// Russia Versions    
        case "magisk-14-0-7-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.7.0.TKXRUXM.RUSSIA.boot.img";
        case "magisk-14-0-6-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.6.0.TKXRUXM.RUSSIA.boot.img";
        case "magisk-14-0-5-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.5.0.TKXRUXM.RUSSIA.boot.img";
        case "magisk-14-0-4-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.4.0.TKXRUXM.RUSSIA.boot.img";
        case "magisk-14-0-3-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.3.0.TKXRUXM.RUSSIA.boot.img";
        case "magisk-14-0-2-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.2.0.TKXRUXM.RUSSIA.boot.img";

	// China Versions	    
        case "magisk-14-0-7-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.7.0.TKXCNXM.CHINA.boot.img";
        case "magisk-14-0-6-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.6.0.TKXCNXM.CHINA.boot.img";
        case "magisk-14-0-5-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.5.0.TKXCNXM.CHINA.boot.img";
        case "magisk-14-0-4-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.4.0.TKXCNXM.CHINA.boot.img";
        
	// Turkey Versions    
        case "magisk-14-0-5-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.5.0.TKXTRXM.TURKEY.boot.img";
        case "magisk-14-0-4-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.4.0.TKXTRXM.TURKEY.boot.img";
        case "magisk-14-0-2-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.2.0.TKXTRXM.TURKEY.boot.img";
        case "magisk-14-0-1-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.1.0.TKXTRXM.TURKEY.boot.img";

	// taiwan Versions	    
        case "magisk-14-0-3-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.3.0.TKXTWXM.TAIWAN.boot.img";
        case "magisk-14-0-2-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.2.0.TKXTWXM.TAIWAN.boot.img";
        case "magisk-14-0-1-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui14-rooted-boot/Magisk.28.NABU.V14.0.1.0.TKXTWXM.TAIWAN.boot.img";

	// MIUI 13 GLOBAL Versions
	case "magisk-13-1-4-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.4.0.SKXMIXM.GLOBAL.boot.img";
        case "magisk-13-1-3-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.3.0.SKXMIXM.GLOBAL.boot.img";
        case "magisk-13-0-4-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.4.0.RKXMIXM.GLOBAL.boot.img";
        case "magisk-13-0-3-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.3.0.RKXMIXM.GLOBAL.boot.img";
        case "magisk-13-0-2-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.2.0.RKXMIXM.GLOBAL.boot.img";
        case "magisk-13-0-1-global":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.1.0.RKXMIXM.GLOBAL.boot.img";

        // India Versions
        case "magisk-13-1-8-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.8.0.SKXINXM.INDIA.boot.img";
        case "magisk-13-1-4-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.4.0.SKXINXM.INDIA.boot.img";
        case "magisk-13-1-3-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.3.0.SKXINXM.INDIA.boot.img";
        case "magisk-13-0-6-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.6.0.RKXINXM.INDIA.boot.img";
        case "magisk-13-0-5-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.5.0.RKXINXM.INDIA.boot.img";
        case "magisk-13-0-4-india":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.4.0.RKXINXM.INDIA.boot.img";

        // Russia Versions
        case "magisk-13-1-6-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.6.0.SKXRUXM.RUSSIA.boot.img";
        case "magisk-13-1-4-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.4.0.SKXRUXM.RUSSIA.boot.img";
        case "magisk-13-0-3-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.3.0.RKXRUXM.RUSSIA.boot.img";
        case "magisk-13-0-2-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.2.0.RKXRUXM.RUSSIA.boot.img";
        case "magisk-13-0-1-russia":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.1.0.RKXRUXM.RUSSIA.boot.img";

        // EEA Versions
        case "magisk-13-1-5-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.5.0.SKXEUXM.EEA.boot.img";
        case "magisk-13-1-3-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.3.0.SKXEUXM.EEA.boot.img";
        case "magisk-13-1-2-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.2.0.SKXEUXM.EEA.boot.img";
        case "magisk-13-0-6-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.6.0.RKXEUXM.EEA.boot.img";
        case "magisk-13-0-5-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.5.0.RKXEUXM.EEA.boot.img";
        case "magisk-13-0-4-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.4.0.RKXEUXM.EEA.boot.img";
        case "magisk-13-0-3-eea":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.3.0.RKXEUXM.EEA.boot.img";

        // China Versions
        case "magisk-13-1-5-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.5.0.SKXCNXM.CHINA.boot.img";
        case "magisk-13-1-4-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.4.0.SKXCNXM.CHINA.boot.img";
        case "magisk-13-0-9-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.9.0.RKXCNXM.CHINA.boot.img";
        case "magisk-13-0-8-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.8.0.RKXCNXM.CHINA.boot.img";
        case "magisk-13-0-5-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.5.0.RKXCNXM.CHINA.boot.img";
        case "magisk-13-0-3-china":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.3.0.RKXCNXM.CHINA.boot.img";

        // Turkey Versions
        case "magisk-13-1-2-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.2.0.SKXTRXM.TURKEY.boot.img";
        case "magisk-13-0-3-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.3.0.RKXTRXM.TURKEY.boot.img";
        case "magisk-13-0-2-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.2.0.RKXTRXM.TURKEY.boot.img";
        case "magisk-13-0-1-turkey":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.1.0.RKXTRXM.TURKEY.boot.img";

	// taiwan Versions
        case "magisk-13-1-2-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.1.2.0.RKXTWXM.TAIWAN.boot.img";
        case "magisk-13-0-4-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.4.0.RKXTWXM.TAIWAN.boot.img";
        case "magisk-13-0-3-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.3.0.RKXTWXM.TAIWAN.boot.img";
        case "magisk-13-0-2-taiwan":
            return "https://raw.githubusercontent.com/arkt-7/nabu-files/main/miui13-rooted-boot/Magisk.27.NABU.V13.0.2.0.RKXTWXM.TAIWAN.boot.img";
		    
        default:
            return null;
    }
}

async function rbootDownloadFlashImage(imagePath) {
    const progressBarContainer = document.querySelector('.rboot-progress-container');
    const progressBar = document.querySelector('.rboot-progress-bar');
    progressBarContainer.style.display = 'block';

    try {
        const response = await fetch(imagePath);
        if (!response.ok) throw new Error("Failed to download flash image");

        const contentLength = response.headers.get('Content-Length');
        const total = parseInt(contentLength, 10);
        let loaded = 0;

        const reader = response.body.getReader();
        const chunks = [];

        while (true) {
            const { done, value } = await reader.read();
            if (done) break;
            chunks.push(value);
            loaded += value.length;
            progressBar.style.width = `${(loaded / total) * 100}%`;
        }

        const blob = new Blob(chunks);
        return blob;
    } catch (error) {
        console.error("Download error:", error);
        alert("Error downloading flash image. Please try again.");
    } finally {
        progressBarContainer.style.display = 'none';
        progressBar.style.width = `0%`;
    }
}

function rbootShowProgressOverlay() {
    const progressBarContainer = document.querySelector('.rboot-progress-container');
    const progressBar = document.querySelector('.rboot-progress-bar');
    progressBarContainer.style.display = 'block';
    progressBar.style.width = '0%';
}

function rbootHideProgressOverlay() {
    const progressBarContainer = document.querySelector('.rboot-progress-container');
    progressBarContainer.style.display = 'none';
}


// Function to handle input and enable the wipe button
function handleWipeInput(event) {
    const wipeButton = document.querySelector(".wipe-button");
    const warningMessage = document.getElementById("warning-message");

    if (event.target.value.toUpperCase() === "FORMAT") {
        wipeButton.disabled = false;
        warningMessage.style.color = "red"; 
    } else {
        wipeButton.disabled = true;
        warningMessage.style.color = ""; 
    }
}

async function wipeDownloadFile(url) {
    try {
        const response = await fetch(url);
        if (!response.ok) throw new Error("Failed to download file");

        const reader = response.body.getReader();
        const chunks = [];

        while (true) {
            const { done, value } = await reader.read();
            if (done) break;
            chunks.push(value);
        }

        return new Blob(chunks);
    } catch (error) {
        console.error("Download error:", error);
        alert("Error downloading file. Please try again.");
    }
}

// Main function to handle the wipe operation
async function wipepart() {
    const wipeButton = document.querySelector(".wipe-button");
    
    // Show confirmation dialog
    const userConfirmed = confirm("⚠️ This will format all data, including Android and Windows (if installed). Do you want to continue?");
    
    if (!userConfirmed) {
        // User canceled, reset the input and button
        document.querySelector(".wipe-input").value = ""; 
        handleWipeInput({ target: { value: "" } }); // Reset wipe button state
        return; // Exit the function
    }
    
    wipeButton.disabled = true; // Disable the button to prevent multiple clicks
    showProgressOverlay();

    try {
        // Step 1: Download and flash GPT file to partition "partition:0"
        let gptBlob = await wipeDownloadFile("https://raw.githubusercontent.com/arkt-7/nabu-files/main/uninstall/gpt_both0.bin");
        await device.flashBlob("partition:0", gptBlob);

        // Step 2: Download and flash userdata to partition "userdata"
        let userdataBlob = await wipeDownloadFile("https://raw.githubusercontent.com/arkt-7/nabu-files/main/uninstall/userdata.img");
        await device.flashBlob("userdata", userdataBlob);

        // Step 3: Execute additional erase commands
        await device.runCommand("erase:metadata");
        await device.runCommand("erase:userdata");

        alert("gpt_both0.bin flashed successfully, and userdata has been erased.");

    } catch (error) {
        alert(`Failed to complete wipe: ${error.message}`);
    } finally {
        document.querySelector(".wipe-input").value = "";
        const warningMessage = document.getElementById("warning-message");
        warningMessage.style.color = ""; 
        hideProgressOverlay();
        await checkDeviceConnection();
    }
}


    document.querySelector(".wipe-input").addEventListener("input", handleWipeInput);
    document.querySelector(".wipe-button").addEventListener("click", wipepart);
    document.querySelector(".wipe-form").addEventListener("submit", function(event) {
	event.preventDefault(); 
    });

    document.querySelector(".connect-button").addEventListener("click", connectDevice);
    document.querySelector(".command-form").addEventListener("submit", sendFormCommand);
    document.querySelector(".reboot-button").addEventListener("click", rebootDevice);
    document.querySelector(".reboot-bootloader-button").addEventListener("click", rebootToBootloader);
    document.querySelector(".reboot-recovery-button").addEventListener("click", rebootToRecovery);
    document.querySelector(".reboot-fastbootd-button").addEventListener("click", rebootToFastbootD);
    document.querySelector(".reboot-edl-button").addEventListener("click", rebootToEDL);
    document.querySelector(".switchslot-button").addEventListener("click", switchSlot);
    document.querySelector(".boot-form").addEventListener("submit", bootFormFile);
    document.querySelector(".flash-form").addEventListener("submit", flashFormFile);
    document.querySelector(".rboot-flash-form").addEventListener("submit", rbootFlashFormFile);

</script>
</body>
</html>
